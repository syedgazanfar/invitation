{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrastyle %}
<style>
.rejection-form {
    max-width: 800px;
    margin: 20px auto;
    padding: 30px;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.rejection-form h1 {
    color: #dc3545;
    border-bottom: 2px solid #dc3545;
    padding-bottom: 15px;
    margin-bottom: 30px;
}

.user-info {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 25px;
}

.user-info h3 {
    margin-top: 0;
    color: #333;
}

.user-info table {
    width: 100%;
}

.user-info td {
    padding: 8px 0;
}

.user-info td:first-child {
    font-weight: 600;
    width: 150px;
    color: #666;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-weight: 600;
    margin-bottom: 8px;
    color: #333;
}

.form-group input,
.form-group textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
}

.form-group input:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #dc3545;
    box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
}

.form-group.checkbox {
    display: flex;
    align-items: center;
    gap: 10px;
}

.form-group.checkbox input {
    width: auto;
}

.form-group.checkbox label {
    margin-bottom: 0;
}

.help-text {
    font-size: 12px;
    color: #666;
    margin-top: 5px;
}

.button-group {
    margin-top: 30px;
    display: flex;
    gap: 15px;
}

.btn {
    padding: 12px 30px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    text-decoration: none;
    display: inline-block;
    transition: all 0.3s ease;
}

.btn-reject {
    background: #dc3545;
    color: white;
}

.btn-reject:hover {
    background: #c82333;
}

.btn-cancel {
    background: #6c757d;
    color: white;
}

.btn-cancel:hover {
    background: #5a6268;
}

.danger-box {
    background: #f8d7da;
    border: 1px solid #dc3545;
    color: #721c24;
    padding: 15px;
    border-radius: 4px;
    margin-bottom: 20px;
}

.required label::after {
    content: " *";
    color: #dc3545;
}
</style>
{% endblock %}

{% block content %}
<div class="rejection-form">
    <h1>
        <i class="icon-cancel"></i>
        Reject User: {{ user.username }}
    </h1>

    <div class="danger-box">
        <strong>⚠ Rejection Action</strong><br>
        You are about to reject this user. This action will be logged and the user will be notified. 
        You can optionally block the user to prevent them from accessing the platform.
    </div>

    <div class="user-info">
        <h3>User Information</h3>
        <table>
            <tr>
                <td>Username:</td>
                <td>{{ user.username }}</td>
            </tr>
            <tr>
                <td>Full Name:</td>
                <td>{{ user.full_name|default:"N/A" }}</td>
            </tr>
            <tr>
                <td>Phone:</td>
                <td>{{ user.phone }}</td>
            </tr>
            <tr>
                <td>Email:</td>
                <td>{{ user.email|default:"N/A" }}</td>
            </tr>
            <tr>
                <td>Registered:</td>
                <td>{{ user.created_at|date:"Y-m-d H:i" }}</td>
            </tr>
            {% if user.current_plan %}
            <tr>
                <td>Selected Plan:</td>
                <td><strong>{{ user.current_plan.name }}</strong></td>
            </tr>
            {% endif %}
        </table>
    </div>

    <form method="post">
        {% csrf_token %}
        
        <div class="form-group required">
            <label for="id_reason">Rejection Reason:</label>
            {{ form.reason }}
            {% if form.reason.help_text %}
            <p class="help-text">{{ form.reason.help_text }}</p>
            {% endif %}
            {% if form.reason.errors %}
            <p class="error-text" style="color: #dc3545; font-size: 12px;">{{ form.reason.errors.0 }}</p>
            {% endif %}
        </div>

        <div class="form-group checkbox">
            {{ form.block_user }}
            <label for="id_block_user">Block user after rejection</label>
        </div>
        {% if form.block_user.help_text %}
        <p class="help-text">{{ form.block_user.help_text }}</p>
        {% endif %}

        <div class="button-group">
            <button type="submit" class="btn btn-reject">
                ✗ Reject User
            </button>
            <a href="{% url 'admin:accounts_user_changelist' %}" class="btn btn-cancel">
                Cancel
            </a>
        </div>
    </form>
</div>
{% endblock %}
